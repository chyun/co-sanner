package com.chyun.scanner.protocol;

/**
 * 类的实现描述: scanner将pptp协议握手包发送给服务器端,
 * 通过服务器端的响应来判断是否开启了pptp协议
 *
 * @author liqun.wu
 */
public class PPTPProxy {
    final static byte[]                           REQ_PPTP         = { 0x00, (byte) 0x9c, 0x00, 0x01, 0x1a, 0x2b, 0x3c,
                                                                       0x4d, 0x00, 0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x03,
                                                                       (byte) 0xff, (byte) 0xff, 0x00, 0x01, 0x6c, 0x6f, 0x63, 0x61, 0x6c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                                                       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                                                       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                                                       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x63,
                                                                       0x61, 0x6e, 0x61, 0x6e, 0x69, 0x61, 0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                                                       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                                                       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                                                       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00  };

    public static byte[] getRequest() {
        return  REQ_PPTP;
    }

    public static boolean isProxy(byte[] data) {
        // match 'PPTP'
        byte b2 = data[2];
        byte b3 = data[3];
        if (b2 == 0x00 && b3 == 0x01) {
            byte b8 = data[8];
            byte b9 = data[9];
            if (b8 == 00 && b9 == 02) {
                return true;
            }
        }
        return false;
    }
}
